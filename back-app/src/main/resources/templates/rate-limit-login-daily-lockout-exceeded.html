<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Cuenta Congelada - Acción Requerida</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="margin: 0; padding: 0; background-color: #f0f4ff; font-family: Arial, Helvetica, sans-serif; line-height: 1.4;">

<!-- Contenedor principal -->
<table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="background-color: #f0f4ff;">
    <tr>
        <td align="center" style="padding: 20px 10px;">

            <!-- Email container -->
            <table role="presentation" cellpadding="0" cellspacing="0" width="600" style="max-width: 600px; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(106, 27, 154, 0.2);">

                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #6a1b9a; padding: 35px 20px; color: #ffffff;">
                        <div style="font-size: 32px; margin-bottom: 12px;">🛡️❄️🛡️</div>
                        <h1 style="margin: 0; font-size: 24px; font-weight: bold; color: #ffffff;">
                            Cuenta Congelada por Seguridad
                        </h1>
                        <p style="margin: 8px 0 0 0; font-size: 14px; color: #f8f9fa; opacity: 0.9;">
                            Posible ataque detectado - Acción requerida
                        </p>
                    </td>
                </tr>

                <!-- Contenido principal -->
                <tr>
                    <td style="padding: 30px 25px; background-color: #ffffff;">

                        <!-- Caja de contenido -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="background-color: #fafbff; border: 2px solid #e1bee7; border-radius: 8px;">
                            <tr>
                                <td style="padding: 25px;">

                                    <!-- Saludo -->
                                    <p style="margin: 0 0 18px 0; font-size: 16px; color: #6a1b9a; font-weight: bold;">
                                        🚨 ¡Hola <span th:text="${username}">Usuario</span>!
                                    </p>

                                    <p style="margin: 0 0 25px 0; font-size: 15px; color: #495057; line-height: 1.5;">
                                        Su cuenta en <strong th:text="${tenantName}">My Logistic CBA</strong> ha sido <strong style="color: #6a1b9a;">CONGELADA</strong> debido a la detección de actividad sospechosa que sugiere un posible ataque a su cuenta. Esta es una medida de protección crítica.
                                    </p>

                                    <!-- Alerta crítica -->
                                    <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 20px;">
                                        <tr>
                                            <td style="background-color: #6a1b9a; border-radius: 8px; padding: 15px; text-align: center;">
                                                <p style="margin: 0; font-size: 14px; color: #ffffff; font-weight: bold; line-height: 1.5;">
                                                    ⚠️ ATENCIÓN: Su cuenta requiere verificación inmediata para ser desbloqueada
                                                </p>
                                            </td>
                                        </tr>
                                    </table>

                                    <!-- Información del incidente -->
                                    <table cellpadding="0" cellspacing="0" width="100%">
                                        <tr>
                                            <td style="padding: 0;">
                                                <div style="background-color: #ffffff; border: 2px solid #6a1b9a; border-radius: 8px; padding: 20px;">
                                                    <p style="margin: 0 0 15px 0; font-size: 13px; color: #6a1b9a; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px;">
                                                        📊 Resumen del Incidente
                                                    </p>

                                                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #e1bee7;">
                                                        <strong style="color: #495057; font-size: 13px;">🔢 Total de intentos fallidos:</strong>
                                                        <div style="font-size: 24px; font-weight: bold; color: #6a1b9a; margin-top: 5px;" th:text="${attemptCount}">15</div>
                                                    </div>

                                                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #e1bee7;">
                                                        <strong style="color: #495057; font-size: 13px;">🔄 Bloqueos temporales activados hoy:</strong>
                                                        <div style="font-size: 24px; font-weight: bold; color: #6a1b9a; margin-top: 5px;" th:text="${lockouts}">3</div>
                                                    </div>

                                                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #e1bee7;">
                                                        <strong style="color: #495057; font-size: 13px;">👤 Usuario afectado:</strong>
                                                        <div style="color: #6c757d; margin-top: 5px; font-size: 13px;" th:text="${username}">usuario123</div>
                                                    </div>

                                                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #f8d7da;">
                                                        <strong style="color: #495057; font-size: 13px;">📧 Correo electrónico:</strong>
                                                        <div style="color: #6c757d; margin-top: 5px; font-size: 12px; word-break: break-all;" th:text="${email}">usuario@example.com</div>
                                                    </div>

                                                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #f8d7da;">
                                                        <strong style="color: #495057; font-size: 13px;">🕐 Último intento:</strong>
                                                        <div style="color: #6c757d; margin-top: 5px; font-size: 13px;" th:text="${#temporals.format(lastAttemptTime, 'dd/MM/yyyy HH:mm:ss')}">30/09/2025 14:30:00</div>
                                                    </div>

                                                    <div>
                                                        <strong style="color: #495057; font-size: 13px;">🔑 Token de verificación:</strong>
                                                        <div style="background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; padding: 8px; margin-top: 5px; font-family: 'Courier New', monospace; font-size: 11px; color: #495057; word-break: break-all;" th:text="${token}">a1b2c3d4-e5f6-7890-abcd-ef1234567890</div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>

                                    <!-- Instrucciones -->
                                    <table cellpadding="0" cellspacing="0" width="100%" style="margin-top: 20px;">
                                        <tr>
                                            <td style="background-color: #fff3cd; border: 2px solid #ffc107; border-radius: 6px; padding: 15px;">
                                                <p style="margin: 0; font-size: 13px; color: #856404; line-height: 1.5;">
                                                    <strong>🔐 Para descongelar su cuenta:</strong><br>
                                                    1. Haga clic en el botón de verificación a continuación<br>
                                                    2. Será redirigido a una página segura de verificación<br>
                                                    3. Complete el proceso de autenticación<br>
                                                    4. Establezca una nueva contraseña segura<br>
                                                    5. Revise la actividad reciente de su cuenta<br>
                                                    6. Si los ataques continuan se recomienda cambiar<br>
                                                       el username de la cuenta
                                                </p>
                                            </td>
                                        </tr>
                                    </table>

                                </td>
                            </tr>
                        </table>

                    </td>
                </tr>

                <!-- Botón de acción principal -->
                <tr>
                    <td style="padding: 0 25px 25px 25px; background-color: #ffffff;">
                        <table cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td align="center" style="padding: 10px 0;">
                                    <table cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td style="background-color: #28a745; border-radius: 8px; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);">
                                                <a th:href="${url}" style="display: block; padding: 18px 40px; color: #ffffff; text-decoration: none; font-weight: bold; font-size: 15px; text-align: center;">
                                                    🔓 DESCONGELAR MI CUENTA AHORA
                                                </a>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>

                        <!-- Link alternativo -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-top: 15px;">
                            <tr>
                                <td style="text-align: center;">
                                    <p style="margin: 0; font-size: 11px; color: #6c757d; line-height: 1.5;">
                                        Si el botón no funciona, copie y pegue este enlace en su navegador:<br>
                                        <a th:href="${url}" style="color: #667eea; word-break: break-all; font-size: 10px;" th:text="${url}">https://example.com/unfreeze/token</a>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Sección de estado crítico -->
                <tr>
                    <td style="padding: 0 25px 25px 25px; background-color: #ffffff;">
                        <table cellpadding="0" cellspacing="0" width="100%" style="background-color: #e1bee7; border: 2px solid #6a1b9a; border-radius: 8px;">
                            <tr>
                                <td style="padding: 15px; text-align: center;">
                                    <p style="margin: 0; font-size: 12px; font-weight: bold; line-height: 1.4;">
                                        <span style="color: #4a148c;">🔒 ESTADO:</span>
                                        <span style="color: #495057;"> Cuenta CONGELADA • Acceso bloqueado • Verificación obligatoria</span>
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Footer -->
                <tr>
                    <td style="padding: 25px; background-color: #f8f9ff; border-top: 1px solid #e9ecef;">

                        <!-- Advertencia crítica -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 15px;">
                            <tr>
                                <td style="background-color: #6a1b9a; border-radius: 6px; padding: 15px;">
                                    <p style="margin: 0; font-size: 12px; color: #ffffff; line-height: 1.5; font-weight: bold; text-align: center;">
                                        ⚠️ IMPORTANTE: Si NO reconoce esta actividad, su cuenta está bajo ataque. Descongelela inmediatamente y cambie su contraseña.
                                    </p>
                                </td>
                            </tr>
                        </table>

                        <!-- Información de seguridad -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 15px;">
                            <tr>
                                <td style="background-color: #e3f2fd; border: 1px solid #bbdefb; border-radius: 6px; padding: 12px;">
                                    <p style="margin: 0; font-size: 12px; color: #1565c0; line-height: 1.5;">
                                        <strong>🛡️ Medidas de protección activas:</strong><br>
                                        • Acceso completamente bloqueado hasta verificación<br>
                                        • Todas las sesiones activas han sido cerradas<br>
                                        • Tokens de acceso previos han sido revocados<br>
                                        • Monitoreo de seguridad intensificado
                                    </p>
                                </td>
                            </tr>
                        </table>

                        <!-- Recomendaciones -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 15px;">
                            <tr>
                                <td style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 6px; padding: 12px;">
                                    <p style="margin: 0; font-size: 12px; color: #155724; line-height: 1.5;">
                                        <strong>✅ Después de descongelar su cuenta:</strong><br>
                                        • Cambie su contraseña inmediatamente<br>
                                        • Active autenticación de dos factores<br>
                                        • Revise dispositivos conectados<br>
                                        • Verifique actividad reciente de la cuenta<br>
                                        • Considere cambiar contraseñas de servicios relacionados
                                    </p>
                                </td>
                            </tr>
                        </table>

                        <!-- Expiración del enlace -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 15px;">
                            <tr>
                                <td style="background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 6px; padding: 12px;">
                                    <p style="margin: 0; font-size: 11px; color: #856404; text-align: center; font-weight: bold;">
                                        ⏰ Este enlace de verificación expirará en 24 horas por seguridad
                                    </p>
                                </td>
                            </tr>
                        </table>

                        <!-- Soporte de emergencia -->
                        <table cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 15px;">
                            <tr>
                                <td style="background-color: #e3f2fd; border: 1px solid #bbdefb; border-radius: 6px; padding: 12px;">
                                    <p style="margin: 0; font-size: 12px; color: #1565c0; text-align: center;">
                                        <strong>📞 Soporte de Emergencia 24/7:</strong><br>
                                        <a href="mailto:mylogisticcba@outlook.com" style="color: #1976d2; text-decoration: underline; font-weight: bold;">
                                            mylogisticcba@outlook.com
                                        </a>
                                    </p>
                                </td>
                            </tr>
                        </table>

                        <!-- Copyright -->
                        <table cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td align="center" style="background-color: #6a1b9a; border-radius: 6px; padding: 12px;">
                                    <p style="margin: 0; font-size: 11px; color: #ffffff; font-weight: bold;">
                                        © 2025 <span>My Logistic CBA</span> | 🔒 Sistema de Seguridad Crítico
                                    </p>
                                </td>
                            </tr>
                        </table>

                    </td>
                </tr>

            </table>

        </td>
    </tr>
</table>

</body>
</html>